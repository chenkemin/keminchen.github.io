<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCU迁移：LIN全协议栈架构对比</title>
    <style>
        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #f4f4f4;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

        /* PPT 幻灯片容器 */
        .ppt-slide {
            width: 1100px; /*稍微加宽以容纳更多细节*/
            height: 620px; /*稍微加高*/
            background-color: #ffffff;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            padding: 25px 35px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
        }

        /* 标题 */
        .slide-title {
            font-size: 26px;
            font-weight: bold;
            color: #222;
            margin-bottom: 20px;
            text-align: center;
            position: relative;
        }
        .slide-title::after {
            content: '';
            display: block;
            width: 60px;
            height: 3px;
            background: #FF8C00;
            margin: 10px auto 0;
        }

        /* 主体内容区域 - 左右布局 */
        .content-body {
            display: flex;
            flex: 1;
            gap: 30px;
            justify-content: center;
            align-items: stretch;
        }

        /* 左右对比列容器 */
        .stack-column {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        /* 平台标题 */
        .platform-header {
            text-align: center;
            margin-bottom: 15px;
            border-bottom: 3px solid transparent;
            padding-bottom: 10px;
        }
        .nxp-header { color: #005EB8; border-color: #005EB8; }
        .infineon-header { color: #E30613; border-color: #E30613; }
        .platform-title { font-size: 22px; font-weight: bold; margin: 0; }
        .platform-subtitle { font-size: 16px; font-weight: normal; }

        /* 分层模块样式 */
        .layer-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 5px;
            position: relative;
            padding: 10px;
            border-radius: 8px;
            background: #f8f9fa;
        }
        .nxp-container { border: 2px dashed #a0c4ff; }
        .infineon-container { border: 2px dashed #ffb3b3; }

        /* 单个层级块 */
        .layer-block {
            padding: 12px 15px;
            border-radius: 6px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            position: relative;
            transition: transform 0.2s;
        }
        .layer-block:hover { transform: translateY(-2px); }
        .layer-title { font-weight: bold; font-size: 15px; display: block; margin-bottom: 4px; }
        .layer-desc { font-size: 12px; color: #555; line-height: 1.3; }
        
        /* 软件层颜色 */
        .sw-layer { background: #eef6fc; border-left: 5px solid #4a90e2; }
        /* 驱动层颜色 */
        .driver-layer { background: #fff4e6; border-left: 5px solid #f5a623; }
        /* 硬件层颜色 */
        .hw-layer { background: #e6ffe6; border-left: 5px solid #50c878; }
        
        /* 特定平台的硬件层强调 */
        .nxp-hw { background: #F0F6FC; border-left-color: #005EB8; }
        .infineon-hw { background: #FFF0F0; border-left-color: #E30613; }

        /* 层级间连接箭头 */
        .stack-arrow {
            text-align: center;
            font-size: 14px;
            color: #777;
            margin: -2px 0;
            z-index: 1;
        }
        .stack-arrow span { font-size: 18px; display: block; }
        .stack-arrow em { font-size: 12px; font-style: normal; color: #999; }

        /* 代码片段嵌入 */
        .embedded-code {
            background: rgba(0,0,0,0.05);
            padding: 4px 8px;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            font-size: 11px;
            display: inline-block;
            margin-top: 5px;
            color: #333;
            border: 1px solid rgba(0,0,0,0.1);
        }

        /* 底部总结 */
        .footer-summary {
            background-color: #333;
            color: white;
            padding: 12px;
            border-radius: 6px;
            margin-top: 20px;
            text-align: center;
            font-size: 14px;
            display: flex;
            justify-content: space-around;
        }
        .footer-item strong { color: #FFD700; }
        .footer-divider { border-left: 1px solid #555; }

    </style>
</head>
<body>

    <div class="ppt-slide">
        <div class="slide-title">MCU迁移：LIN全协议栈 (Protocol & TP) 架构对比</div>

        <div class="content-body">
            
            <div class="stack-column">
                <div class="platform-header nxp-header">
                    <h3 class="platform-title">NXP S32K1xx (旧)</h3>
                    <span class="platform-subtitle">方式：数据驱动 (Data-Driven)</span>
                </div>
                <div class="layer-container nxp-container">
                    <div class="layer-block sw-layer">
                        <span class="layer-title">协议层 & 传输层 (Protocol & TP)</span>
                        <span class="layer-desc">特点：软件负担重。需手动管理时序、拼包、计算部分校验和。TP层需精确调度字节流。</span>
                    </div>
                    
                    <div class="stack-arrow"><span>⬇️</span><em>紧耦合：字节流调用 & 状态轮询</em></div>
                    
                    <div class="layer-block driver-layer">
                        <span class="layer-title">LIN 驱动层 (Driver ISR)</span>
                        <span class="layer-desc">行为：微操硬件。在中断中搬运单个字节，手动清除标志位。</span>
                        <code class="embedded-code">LPUART->DATA = byte; // 发一个字节</code>
                    </div>
                    
                    <div class="stack-arrow"><span>⬇️</span><em>直接写数据寄存器</em></div>
                    
                    <div class="layer-block hw-layer nxp-hw">
                        <span class="layer-title">硬件外设 (LPUART)</span>
                        <span class="layer-desc">角色："数据管道"。只负责移位发送，对 LIN 帧结构感知较弱。</span>
                    </div>
                </div>
            </div>

            <div class="stack-column">
                <div class="platform-header infineon-header">
                    <h3 class="platform-title">Infineon CYT2B7x (新)</h3>
                    <span class="platform-subtitle">方式：命令驱动 (Command-Driven)</span>
                </div>
                <div class="layer-container infineon-container">
                    <div class="layer-block sw-layer">
                        <span class="layer-title">协议层 & 传输层 (Protocol & TP)</span>
                        <span class="layer-desc">特点：软件轻量化。TP层只需准备完整 Buffer，下达传输请求，无需关注字节时序。</span>
                    </div>
                    
                    <div class="stack-arrow"><span>⬇️</span><em>松耦合：事务性请求 & 事件回调</em></div>
                    
                    <div class="layer-block driver-layer">
                        <span class="layer-title">LIN 驱动层 (Driver ISR)</span>
                        <span class="layer-desc">行为：下达高级指令。基于事件（如 Wakeup/Header Done）驱动状态机。</span>
                        <code class="embedded-code">SCB->CMD = TX_HEADER; // 发整个帧头</code>
                    </div>
                    
                    <div class="stack-arrow"><span>⬇️</span><em>写 CMD 命令寄存器</em></div>
                    
                    <div class="layer-block hw-layer infineon-hw">
                        <span class="layer-title">硬件外设 (SCB LIN Engine)</span>
                        <span class="layer-desc">角色："智能引擎"。全硬件托管帧结构、同步、校验和计算。</span>
                    </div>
                </div>
            </div>

        </div>

        <div class="footer-summary">
            <div class="footer-item">
                迁移挑战：<strong>解耦旧的ISR逻辑</strong>。<br>不要照搬 S32K 的字节处理方式。
            </div>
            <div class="footer-divider"></div>
            <div class="footer-item">
                迁移机遇：<strong>简化上层软件</strong>。<br>利用 CYT2B 硬件特性，TP层和协议层代码可大幅瘦身。
            </div>
        </div>
    </div>

</body>
</html>
